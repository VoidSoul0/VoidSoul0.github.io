<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"voidsoul0.github.io","root":"/","scheme":"Gemini","version":"8.0.0-rc.4","exturl":false,"sidebar":{"position":"left","width":200,"display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言：需求分析在项目的数据查询中，最简单的是查询一个表里的内容，但是最常用的却是多表关联查询。比如  根据某个职业的分类查询这个分类下所有角色(对象)的相关信息 根据多个角色的信息查询它们各自所属的职业分类 根据某个角色的标签查询这个标签下的角色，或者根据这个角色查询他有哪些标签  以上例子依次对应了数据查询中一对多、多对一和多对多的情况，接下来将通过一个简单的项目介绍如何在mybatis里如何配">
<meta property="og:type" content="article">
<meta property="og:title" content="mybatis多表关联映射(一对多、多对一、多对多)的配置与使用">
<meta property="og:url" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/index.html">
<meta property="og:site_name" content="Lv.0">
<meta property="og:description" content="前言：需求分析在项目的数据查询中，最简单的是查询一个表里的内容，但是最常用的却是多表关联查询。比如  根据某个职业的分类查询这个分类下所有角色(对象)的相关信息 根据多个角色的信息查询它们各自所属的职业分类 根据某个角色的标签查询这个标签下的角色，或者根据这个角色查询他有哪些标签  以上例子依次对应了数据查询中一对多、多对一和多对多的情况，接下来将通过一个简单的项目介绍如何在mybatis里如何配">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/4026165801.png">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/3024637912.png">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/1025955090.png">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/3346185465.png">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/4108606847.png">
<meta property="og:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/3064026697.png">
<meta property="article:published_time" content="2020-03-16T07:25:00.000Z">
<meta property="article:modified_time" content="2020-03-16T07:25:00.000Z">
<meta property="article:author" content="VoidSoul">
<meta property="article:tag" content="java">
<meta property="article:tag" content="mysql">
<meta property="article:tag" content="mybatis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://voidsoul0.github.io/mybatis/mybatis-association-query/4026165801.png">

<link rel="canonical" href="https://voidsoul0.github.io/mybatis/mybatis-association-query/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>mybatis多表关联映射(一对多、多对一、多对多)的配置与使用 | Lv.0</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Lv.0</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言：需求分析"><span class="nav-text">前言：需求分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一、创建项目"><span class="nav-text">一、创建项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-创建数据表-amp-插入数据"><span class="nav-text">1.创建数据表&amp;插入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-项目结构"><span class="nav-text">2.项目结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-初始化项目"><span class="nav-text">3.初始化项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1配置mybatis"><span class="nav-text">3.1配置mybatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2封装sql会话访问工具类"><span class="nav-text">3.2封装sql会话访问工具类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3创建java对象类"><span class="nav-text">3.3创建java对象类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、一对多"><span class="nav-text">二、一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-逻辑梳理"><span class="nav-text">1.逻辑梳理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-charWorkMapper映射文件设置"><span class="nav-text">2.charWorkMapper映射文件设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-charatersMapper映射文件设置"><span class="nav-text">3.charatersMapper映射文件设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-实例测试"><span class="nav-text">4.实例测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、多对一"><span class="nav-text">三、多对一</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-逻辑梳理-1"><span class="nav-text">1.逻辑梳理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-charInfoMapper新增设置"><span class="nav-text">2.charInfoMapper新增设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-charWorkMapper新增设置"><span class="nav-text">3.charWorkMapper新增设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-实例测试-1"><span class="nav-text">4.实例测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、多对多"><span class="nav-text">四、多对多</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-增加数据表"><span class="nav-text">1.增加数据表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-增加对象与字段"><span class="nav-text">2.增加对象与字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-增加映射配置"><span class="nav-text">3.增加映射配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-实例测试-2"><span class="nav-text">4.实例测试</span></a></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="VoidSoul"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">VoidSoul</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/VoidSoul0" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;VoidSoul0" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:360301524@qq.com" title="E-Mail → mailto:360301524@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://voidsoul0.github.io/mybatis/mybatis-association-query/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="VoidSoul">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lv.0">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mybatis多表关联映射(一对多、多对一、多对多)的配置与使用
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-16 15:25:00" itemprop="dateCreated datePublished" datetime="2020-03-16T15:25:00+08:00">2020-03-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index"><span itemprop="name">mybatis</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>10k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>18 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="前言：需求分析"><a href="#前言：需求分析" class="headerlink" title="前言：需求分析"></a>前言：需求分析</h2><p>在项目的数据查询中，最简单的是查询一个表里的内容，但是最常用的却是多表关联查询。比如</p>
<ul>
<li>根据某个职业的分类查询这个分类下所有角色(对象)的相关信息</li>
<li>根据多个角色的信息查询它们各自所属的职业分类</li>
<li>根据某个角色的标签查询这个标签下的角色，或者根据这个角色查询他有哪些标签</li>
</ul>
<p>以上例子依次对应了数据查询中<strong>一对多、多对一和多对多</strong>的情况，接下来将通过一个简单的项目介绍如何在mybatis里如何配置与使用这些多表关联查询</p>
<a id="more"></a>

<hr>
<h2 id="一、创建项目"><a href="#一、创建项目" class="headerlink" title="一、创建项目"></a>一、创建项目</h2><h3 id="1-创建数据表-amp-插入数据"><a href="#1-创建数据表-amp-插入数据" class="headerlink" title="1.创建数据表&amp;插入数据"></a>1.创建数据表&amp;插入数据</h3><p>角色表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`char_info`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  <span class="string">`star`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  <span class="string">`initial_cost`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</span><br><span class="line">  <span class="string">`work_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  <span class="string">`work_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`name`</span> (<span class="string">`name`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> char_info <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">'能天使'</span>,<span class="string">'6星'</span>,<span class="number">12</span>,<span class="string">'狙击'</span>,<span class="number">101</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">'陨星'</span>,<span class="string">'5星'</span>,<span class="number">24</span>,<span class="string">'狙击'</span>,<span class="number">101</span>),(<span class="number">3</span>,<span class="string">'伊芙利特'</span>,<span class="string">'6星'</span>,<span class="number">31</span>,<span class="string">'术士'</span>,<span class="number">102</span>),</span><br><span class="line">(<span class="number">4</span>,<span class="string">'莫斯提马'</span>,<span class="string">'6星'</span>,<span class="number">31</span>,<span class="string">'术士'</span>,<span class="number">102</span>),(<span class="number">5</span>,<span class="string">'艾雅法拉'</span>,<span class="string">'6星'</span>,<span class="number">19</span>,<span class="string">'术士'</span>,<span class="number">102</span>),</span><br><span class="line">(<span class="number">6</span>,<span class="string">'阿米娅'</span>,<span class="string">'5星'</span>,<span class="number">18</span>,<span class="string">'术士'</span>,<span class="number">102</span>),(<span class="number">7</span>,<span class="string">'银灰'</span>,<span class="string">'6星'</span>,<span class="number">18</span>,<span class="string">'近卫'</span>,<span class="number">103</span>),</span><br><span class="line">(<span class="number">8</span>,<span class="string">'斯卡蒂'</span>,<span class="string">'6星'</span>,<span class="number">17</span>,<span class="string">'近卫'</span>,<span class="number">103</span>),(<span class="number">9</span>,<span class="string">'推进之王'</span>,<span class="string">'6星'</span>,<span class="number">12</span>,<span class="string">'先锋'</span>,<span class="number">104</span>),</span><br><span class="line">(<span class="number">10</span>,<span class="string">'红'</span>,<span class="string">'5星'</span>,<span class="number">7</span>,<span class="string">'特种'</span>,<span class="number">105</span>),(<span class="number">11</span>,<span class="string">'年'</span>,<span class="string">'6星'</span>,<span class="number">19</span>,<span class="string">'重装'</span>,<span class="number">106</span>);</span><br></pre></td></tr></table></figure>

<p>职业分类表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`char_work`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`work_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`work`</span> (<span class="string">`name`</span>,<span class="string">`work_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`char_work`</span> <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">101</span>,<span class="string">'狙击'</span>),(<span class="number">2</span>,<span class="number">102</span>,<span class="string">'术士'</span>),(<span class="number">3</span>,<span class="number">103</span>,<span class="string">'近卫'</span>),(<span class="number">4</span>,<span class="number">104</span>,<span class="string">'先锋'</span>),(<span class="number">5</span>,<span class="number">105</span>,<span class="string">'特种'</span>),(<span class="number">6</span>,<span class="number">106</span>,<span class="string">'重装'</span>),(<span class="number">7</span>,<span class="number">107</span>,<span class="string">'医疗'</span>),(<span class="number">8</span>,<span class="number">108</span>,<span class="string">'辅助'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="2-项目结构"><a href="#2-项目结构" class="headerlink" title="2.项目结构"></a>2.项目结构</h3><p><img src="4026165801.png" alt="img"></p>
<p>本项目使用IntelliJ IDEA创建，并使用maven管理所使用的相关库，如果不使用maven，请注意手动导入相关jar包：mybatis、mysql-connector-java。junit可选，仅作测试用(使用junit必须依赖hamcrest-core包)</p>
<h3 id="3-初始化项目"><a href="#3-初始化项目" class="headerlink" title="3.初始化项目"></a>3.初始化项目</h3><h4 id="3-1配置mybatis"><a href="#3-1配置mybatis" class="headerlink" title="3.1配置mybatis"></a>3.1配置mybatis</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">		<span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">		<span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=false"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mappers/charInfoMapper.xml"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mappers/charWorkMapper.xml"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>设置<code>mapUnderscoreToCamelCase</code>为<code>true</code>开启驼峰命名规则转换，即数据表的字段名xxx_yyy转换成java的字段名xxxYyy<br>此处使用的mysql连接驱动包是5.x版本的，如果使用8.x注意更改驱动名称值为<code>com.mysql.cj.jdbc.Driver</code>，同时url需要指定参数<code>useSSL=false&amp;serverTimezone=UTC</code></p>
<h4 id="3-2封装sql会话访问工具类"><a href="#3-2封装sql会话访问工具类" class="headerlink" title="3.2封装sql会话访问工具类"></a>3.2封装sql会话访问工具类</h4><p>在util包下新建MybatisUtil类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">	<span class="keyword">try</span> (InputStream inputStream = Resources.getResourceAsStream(<span class="string">"mybatis-config.xml"</span>)) &#123;</span><br><span class="line">		sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">openSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-3创建java对象类"><a href="#3-3创建java对象类" class="headerlink" title="3.3创建java对象类"></a>3.3创建java对象类</h4><p>在pojo包下新建与数据表相关的java对象和字段信息，并生成Getter与Setter方法，同时重写toString方法方便打印信息。本项目仅使用了查询功能，所以不用生成带参构造方法</p>
<hr>
<h2 id="二、一对多"><a href="#二、一对多" class="headerlink" title="二、一对多"></a>二、一对多</h2><h3 id="1-逻辑梳理"><a href="#1-逻辑梳理" class="headerlink" title="1.逻辑梳理"></a>1.逻辑梳理</h3><p>首先理清关系，一对多即一个对象关联多个对象，那么就需要使用同一个字段值来产生关系，所以此处char_info表引用了char_work表的work_id。在查询的时候逻辑顺序如下：</p>
<ol>
<li>在char_work表中通过name值(也可以使用表里其它的唯一值)查询相关的work_id</li>
<li>然后返回一个结果映射，在结果映射里通过work_id在char_info里查询到对应的char_info数据</li>
<li>返回的结果映射同时拥有char_work的信息和其相关的一组char_info数据</li>
</ol>
<p>所以我们需要在CharWork对象里增加一个<code>List&lt;charInfo&gt;</code>属性并生成Getter与Setter方法</p>
<h3 id="2-charWorkMapper映射文件设置"><a href="#2-charWorkMapper映射文件设置" class="headerlink" title="2.charWorkMapper映射文件设置"></a>2.charWorkMapper映射文件设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"charWork"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--一对多结果映射：一类职业对应多名干员--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"rmCharWork"</span> <span class="attr">type</span>=<span class="string">"pojo.CharWork"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"charInfoList"</span> <span class="attr">select</span>=<span class="string">"charInfo.selectCharInfoByWorkId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectCharInfoByWorkName"</span> <span class="attr">resultMap</span>=<span class="string">"rmCharWork"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span>&gt;</span></span><br><span class="line">		select * from char_work where name = #&#123;value&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>此处resultMap的type即“一”的java对象类型，子标签id为主键，需要关联的属性和不符合驼峰命名转换规则的属性使用result子标签进行对应，property为java属性名，column为数据表字段名。<br>collection的select值为charInfo命名空间(映射文件)里需要关联查询的select语句id</p>
<h3 id="3-charatersMapper映射文件设置"><a href="#3-charatersMapper映射文件设置" class="headerlink" title="3.charatersMapper映射文件设置"></a>3.charatersMapper映射文件设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">		<span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">		<span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"charaters"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectCharInfoByWorkId"</span> <span class="attr">resultType</span>=<span class="string">"pojo.CharInfo"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">		select * from char_info where work_id = #&#123;value&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>此处设置work_id值查询charInfo数据即可，无需手动调用</p>
<h3 id="4-实例测试"><a href="#4-实例测试" class="headerlink" title="4.实例测试"></a>4.实例测试</h3><p>test\java包里新建测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">one2many</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> (SqlSession sqlSession = MybatisUtil.openSession()) &#123;</span><br><span class="line">		CharWork work = sqlSession.selectOne(<span class="string">"charWork.selectCharInfoByWorkName"</span>, <span class="string">"狙击"</span>);</span><br><span class="line">		List&lt;CharInfo&gt; charaters = work.getCharInfoList();</span><br><span class="line"></span><br><span class="line">		System.out.println(work);</span><br><span class="line">		<span class="keyword">for</span> (CharInfo c : charaters) &#123;</span><br><span class="line">			System.out.println(<span class="string">"\t"</span> + c);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果如下</p>
<p><img src="3024637912.png" alt="img"></p>
<hr>
<h2 id="三、多对一"><a href="#三、多对一" class="headerlink" title="三、多对一"></a>三、多对一</h2><h3 id="1-逻辑梳理-1"><a href="#1-逻辑梳理-1" class="headerlink" title="1.逻辑梳理"></a>1.逻辑梳理</h3><p>多对一体现在查询结果上并不是多个实体对象显示对应的一条分类对象信息，而是每个实体对象后面显示其关联的分类对象信息，显示的“一”可以显示很多条重复的，但都是同一类对象，所以逻辑顺序如下：</p>
<ol>
<li>从char_info表查询所需的一组char_info信息</li>
<li>然后在结果映射里通过这一组char_info的work_id到char_work表里逐条查询所需的char_work信息</li>
<li>返回的结果映射信息就有了char_info信息以及对应的char_work信息</li>
</ol>
<p>那么很显然的我们需要在char_info的java对象里增加一个<code>charWork</code>对象属性，并生成相应的Setter和Getter方法</p>
<h3 id="2-charInfoMapper新增设置"><a href="#2-charInfoMapper新增设置" class="headerlink" title="2.charInfoMapper新增设置"></a>2.charInfoMapper新增设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多对一结果映射：多名干员对应符合条件的一类职业--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"rmCharInfo"</span> <span class="attr">type</span>=<span class="string">"pojo.CharInfo"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"charWork"</span> <span class="attr">select</span>=<span class="string">"charWork.selectCharWorkByWorkId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectCharInfo"</span> <span class="attr">resultMap</span>=<span class="string">"rmCharInfo"</span>&gt;</span></span><br><span class="line">	select *</span><br><span class="line">	from char_info</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>此处resultMap使用<code>association</code>(映射)子标签来实现多对一的查询，原理和一对多相似，不过和collection不同的是association只能映射一个对象而不是一组对象的集合，同时依旧需要把传递的work_id属性进行result对应，否则CharInfo对象会获取不到work_id的值</p>
<h3 id="3-charWorkMapper新增设置"><a href="#3-charWorkMapper新增设置" class="headerlink" title="3.charWorkMapper新增设置"></a>3.charWorkMapper新增设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectCharWorkByWorkId"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"pojo.CharWork"</span>&gt;</span></span><br><span class="line">	select * from char_work where work_id = #&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>“一”的一边只需要增加一条sql语句就行了</p>
<h3 id="4-实例测试-1"><a href="#4-实例测试-1" class="headerlink" title="4.实例测试"></a>4.实例测试</h3><p>在测试类里新建一个many2one测试方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">many2one</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> (SqlSession sqlSession = MybatisUtil.openSession()) &#123;</span><br><span class="line">		List&lt;CharInfo&gt; charInfos = sqlSession.selectList(<span class="string">"charInfo.selectCharInfo"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (CharInfo c : charInfos) &#123;</span><br><span class="line">			System.out.println(c);</span><br><span class="line">			System.out.println(<span class="string">"\t"</span> + c.getCharWork());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里取出全部的CharInfo及其charWork信息，所以就不需要传递参数了，同时变量声明是先集合，再对应的单个对象，和一对多的使用方法是相反的</p>
<p>运行结果：</p>
<p><img src="1025955090.png" alt="img"></p>
<hr>
<h2 id="四、多对多"><a href="#四、多对多" class="headerlink" title="四、多对多"></a>四、多对多</h2><p>虽然mybatis可以使用association和collection标签专门用于对多个相关实体类数据进行级联查询，但仍不支持多个相关实体类数据的级联保存和级联删除操作。因此在进行实体类多对多映射表设计时，需要专门建立一个关联对象表对相关实体类的关联关系进行描述，所以多对多的处理可视为双向的一对多表查询</p>
<h3 id="1-增加数据表"><a href="#1-增加数据表" class="headerlink" title="1.增加数据表"></a>1.增加数据表</h3><p>tag</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tag`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`tag_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`tag`</span> (<span class="string">`tag_name`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">16</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tag`</span> <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">'治疗'</span>),(<span class="number">2</span>,<span class="string">'支援'</span>),(<span class="number">3</span>,<span class="string">'新手'</span>),(<span class="number">4</span>,<span class="string">'费用回复'</span>),(<span class="number">5</span>,<span class="string">'输出'</span>),(<span class="number">6</span>,<span class="string">'生存'</span>),(<span class="number">7</span>,<span class="string">'群攻'</span>),(<span class="number">8</span>,<span class="string">'防护'</span>),(<span class="number">9</span>,<span class="string">'减速'</span>),(<span class="number">10</span>,<span class="string">'削弱'</span>),(<span class="number">11</span>,<span class="string">'快速复活'</span>),(<span class="number">12</span>,<span class="string">'位移'</span>),(<span class="number">13</span>,<span class="string">'召唤'</span>),(<span class="number">14</span>,<span class="string">'控场'</span>),(<span class="number">15</span>,<span class="string">'爆发'</span>);</span><br></pre></td></tr></table></figure>

<p>char_tags</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`char_tags`</span> (</span><br><span class="line">  <span class="string">`cid`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</span><br><span class="line">  <span class="string">`tid`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`char_tags`</span> <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">5</span>),(<span class="number">2</span>,<span class="number">7</span>),(<span class="number">2</span>,<span class="number">10</span>),(<span class="number">3</span>,<span class="number">7</span>),(<span class="number">3</span>,<span class="number">10</span>),(<span class="number">4</span>,<span class="number">2</span>),(<span class="number">4</span>,<span class="number">7</span>),(<span class="number">4</span>,<span class="number">14</span>),(<span class="number">5</span>,<span class="number">5</span>),(<span class="number">5</span>,<span class="number">10</span>),(<span class="number">6</span>,<span class="number">5</span>),(<span class="number">7</span>,<span class="number">2</span>),(<span class="number">7</span>,<span class="number">5</span>),(<span class="number">8</span>,<span class="number">5</span>),(<span class="number">8</span>,<span class="number">6</span>),(<span class="number">9</span>,<span class="number">4</span>),(<span class="number">9</span>,<span class="number">5</span>),(<span class="number">10</span>,<span class="number">11</span>),(<span class="number">10</span>,<span class="number">14</span>),(<span class="number">11</span>,<span class="number">2</span>),(<span class="number">11</span>,<span class="number">8</span>);</span><br></pre></td></tr></table></figure>

<h3 id="2-增加对象与字段"><a href="#2-增加对象与字段" class="headerlink" title="2.增加对象与字段"></a>2.增加对象与字段</h3><p>pojo包下新增tag类与相关属性，对应tag表，同时增加List<CharInfo>属性，在CharInfo类里也增加一个List<tag>属性，此处无需char_tags表关联java类</p>
<h3 id="3-增加映射配置"><a href="#3-增加映射配置" class="headerlink" title="3.增加映射配置"></a>3.增加映射配置</h3><p>charInfoMapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多对多结果映射：查询某个干员所对应的多个标签--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"rmCharInfoWithTags"</span> <span class="attr">type</span>=<span class="string">"pojo.CharInfo"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"star"</span> <span class="attr">column</span>=<span class="string">"star"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"initialCost"</span> <span class="attr">column</span>=<span class="string">"initial_cost"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workName"</span> <span class="attr">column</span>=<span class="string">"work_name"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"tags"</span> <span class="attr">ofType</span>=<span class="string">"pojo.tag"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"tagName"</span> <span class="attr">column</span>=<span class="string">"tag_name"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectCharInfoWithTags"</span> <span class="attr">resultMap</span>=<span class="string">"rmCharInfoWithTags"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span>&gt;</span></span><br><span class="line">	select *</span><br><span class="line">	from char_info c, tag t, char_tags ct</span><br><span class="line">	where ct.cid = c.id</span><br><span class="line">	  and ct.tid = t.id</span><br><span class="line">	  and c.name = #&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用SQL语句对应来实现多表关联的查询，如果不理解这条select语句，可以代入参数在mysql里观察查询结果：</p>
<p><img src="3346185465.png" alt="img"></p>
<p>因为使用了*取出了所有表的所有列，会有列名重复的情况，所以在result或id里不能指定<code>property=&quot;id&quot; column=&quot;id&quot;</code>这样的参数映射，否则只会映射第一次出现的数据，后面重复列名的数据无法映射。同时这里需要将相关表(除了关系表)所对应的java对象类的属性完整映射，重复的列名一般来说就是关联的字段信息了，所以可以如上使用<code>&lt;id property=&quot;id&quot; column=&quot;cid&quot;/&gt;</code>这样的方式来映射。</p>
<p>新增tagMapper映射文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多对多结果映射：查询某个标签所对应的多个干员--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"rmTagsWithCharInfo"</span> <span class="attr">type</span>=<span class="string">"pojo.tag"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"tagName"</span> <span class="attr">column</span>=<span class="string">"tag_name"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"charaters"</span> <span class="attr">ofType</span>=<span class="string">"pojo.CharInfo"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"star"</span> <span class="attr">column</span>=<span class="string">"star"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"initialCost"</span> <span class="attr">column</span>=<span class="string">"initial_cost"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workName"</span> <span class="attr">column</span>=<span class="string">"work_name"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"workId"</span> <span class="attr">column</span>=<span class="string">"work_id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectTagsWithCharInfo"</span> <span class="attr">resultMap</span>=<span class="string">"rmTagsWithCharInfo"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span>&gt;</span></span><br><span class="line">	select *</span><br><span class="line">	from char_info c, tag t, char_tags ct</span><br><span class="line">	where ct.cid = c.id</span><br><span class="line">	  and ct.tid = t.id</span><br><span class="line">	  and t.tag_name = #&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>逆向的关系映射与上面原理相同，将属性/字段反向描述即可，注意select语句的参数，以及在mybatis配置文件里增加映射文件<code>&lt;mapper resource=&quot;mappers/tagMapper.xml&quot;/&gt;</code></p>
<h3 id="4-实例测试-2"><a href="#4-实例测试-2" class="headerlink" title="4.实例测试"></a>4.实例测试</h3><p>正向：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">many2many</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> (SqlSession sqlSession = MybatisUtil.openSession()) &#123;</span><br><span class="line">		CharInfo charInfo = sqlSession.selectOne(<span class="string">"charInfo.selectCharInfoWithTags"</span>, <span class="string">"莫斯提马"</span>);</span><br><span class="line">		List&lt;pojo.tag&gt; tags = charInfo.getTags();</span><br><span class="line"></span><br><span class="line">		System.out.println(charInfo);</span><br><span class="line">		<span class="keyword">for</span> (tag t : tags) &#123;</span><br><span class="line">			System.out.println(<span class="string">"\t"</span> + t);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="4108606847.png" alt="img"></p>
<p>逆向：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">manyToMany</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> (SqlSession sqlSession = MybatisUtil.openSession()) &#123;</span><br><span class="line">		tag tag = sqlSession.selectOne(<span class="string">"tag.selectTagsWithCharInfo"</span>, <span class="string">"削弱"</span>);</span><br><span class="line">		List&lt;CharInfo&gt; charInfos = tag.getCharaters();</span><br><span class="line"></span><br><span class="line">		System.out.println(tag);</span><br><span class="line">		<span class="keyword">for</span> (CharInfo charInfo : charInfos) &#123;</span><br><span class="line">			System.out.println(<span class="string">"\t"</span> + charInfo);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="3064026697.png" alt="img"></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>VoidSoul
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://voidsoul0.github.io/mybatis/mybatis-association-query/" title="mybatis多表关联映射(一对多、多对一、多对多)的配置与使用">https://voidsoul0.github.io/mybatis/mybatis-association-query/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/java/" rel="tag"><i class="fa fa-tag"></i> java</a>
              <a href="/tags/mysql/" rel="tag"><i class="fa fa-tag"></i> mysql</a>
              <a href="/tags/mybatis/" rel="tag"><i class="fa fa-tag"></i> mybatis</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/spring/spring-aspectj-aop/" rel="next" title="Spring基于AspectJ的AOP示例">
      Spring基于AspectJ的AOP示例 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user-circle"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">VoidSoul</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">79k</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/next-boot.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
